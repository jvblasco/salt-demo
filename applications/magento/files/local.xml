<?xml version="1.0"?>
<!--
/**
* *** DO NOT EDIT THIS FILE ***
* This file is managed by Salt.
* Any changes will be overwritten.
*/
-->
<config>
    <global>
        <install>
            <date><![CDATA[Wed, 07 Nov 2012 15:12:30 +0000]]></date>
        </install>
        <crypt>
            <key><![CDATA[{{ app['key'] }}]]></key>
        </crypt>
        <disable_local_modules>false</disable_local_modules>
        <resources>
	    {%- for database in app['databases'] %}
	    {%- if database['main'] %}
            <db>
                {%- if database['prefix'] %}
                <table_prefix><![CDATA[{{ database['prefix'] }}]]></table_prefix>
                {%- else %}
                <table_prefix><![CDATA[]]></table_prefix>
                {%- endif %}
            </db>
            <default_setup>
                <connection>
                    <host><![CDATA[{{ database['host'] }}]]></host>
                    <username><![CDATA[{{ database['user'] }}]]></username>
                    <password><![CDATA[{{ database['password'] }}]]></password>
                    <dbname><![CDATA[{{ database['name'] }}]]></dbname>
                    <initStatements><![CDATA[SET NAMES utf8]]></initStatements>
                    <model><![CDATA[mysql4]]></model>
                    <type><![CDATA[pdo_mysql]]></type>
                    <pdoType><![CDATA[]]></pdoType>
                    <active>1</active>
                </connection>
            </default_setup>
	    {%- else %}
	    <{{ database['name'] }}_setup>
                <connection>
                    <use>{{ database['name'] }}_database</use>
                </connection>
            </{{ database['name'] }}_setup>
            <{{ database['name'] }}_database>
                <connection>
                    <host><![CDATA[{{ database['host'] }}]]></host>
                    <username><![CDATA[{{ database['user'] }}]]></username>
                    <password><![CDATA[{{ database['password'] }}]]></password>
                    <dbname><![CDATA[{{ database['name'] }}]]></dbname>
                    <initStatements><![CDATA[SET NAMES utf8]]></initStatements>
                    <model>mysql4</model>
                    <type>pdo_mysql</type>
                    <active>1</active>
                </connection>
            </{{ database['name'] }}_database>
            {%- endif %}
            {%- endfor %}
        </resources>
        {%- if app['session']['type'] == 'redis' %}
        <session_save><![CDATA[db]]></session_save>
        <redis_session>
            <host><![CDATA[{{ app['session']['host'] }}]]></host>
            <port><![CDATA[{{ app['session']['port'] }}]]></port>
            <timeout><![CDATA[3]]></timeout>
            <db><![CDATA[0]]></db>
            <compression_threshold><![CDATA[2048]]></compression_threshold>
            <min_lifetime>3600</min_lifetime>
            <compression_lib><![CDATA[gzip]]></compression_lib>
            {%- if app['session']['disable_locking'] %}
            <disable_locking>1</disable_locking>
            {%- endif %}
            {%- if app['session']['max_concurrency'] %}
            <max_concurrency><![CDATA[{{ data['session']['max_concurrency'] }}]]></max_concurrency>
            {%- else %}
            <max_concurrency>6</max_concurrency>
            {%- endif %}
        </redis_session>
        {%- elif app['session']['type'] == 'files' %}
        <session_save><![CDATA[files]]></session_save>
        {%- endif %}
        <cache>
        {%- if app['cache']['type'] == 'redis' %}
            <backend>Cm_Cache_Backend_Redis</backend>
            <backend_options>
                <server>{{ app['cache']['host'] }}</server>
                <port>{{ app['cache']['port'] }}</port>
                <database>1</database>
                <password></password>
                <force_standalone>0</force_standalone>
                <connect_retries>1</connect_retries>
                <read_timeout>10</read_timeout>
                <automatic_cleaning_factor>0</automatic_cleaning_factor>
                <compress_data>1</compress_data>
                <compress_tags>1</compress_tags>
                <compress_threshold>20480</compress_threshold>
                <compression_lib>gzip</compression_lib>
            </backend_options>
        {%- elif app['cache']['type'] == 'files' %}
            <backend><![CDATA[files]]></backend>
            <prefix>MAGE_</prefix>
        {%- endif %}
        </cache>
        {%- if app['full_page_cache'] %}
        <full_page_cache>
            <backend>Cm_Cache_Backend_Redis</backend>
            <backend_options>
                <server><![CDATA[{{ app['full_page_cache']['host'] }}]]></server>
                <port><![CDATA[{{ app['full_page_cache']['port'] }}]]></port>
                <database><![CDATA[2]]></database>
                <force_standalone>0</force_standalone>
                <connect_retries>1</connect_retries>
                <lifetimelimit>57600</lifetimelimit>
                <compress_data>0</compress_data>
            </backend_options>
        </full_page_cache>
        {%- endif %}
        {%- if app['fpc'] %}
        <fpc>
            <lifetime>86400</lifetime>
            <backend>Cm_Cache_Backend_Redis</backend>
            <backend_options>
                <server><![CDATA[{{ app['fpc']['host'] }}]]></server>
                <port><![CDATA[{{ app['fpc']['port'] }}]]></port>
                <database><![CDATA[2]]></database>
                <persistent>cache-fpc</persistent>
                <password></password>
                <force_standalone>1</force_standalone>
                <connect_retries>1</connect_retries>
                <lifetimelimit>86400</lifetimelimit>
                <read_timeout>10</read_timeout>
                <compress_data>1</compress_data>
                <compress_tags>1</compress_tags>
                <compress_data>gzip</compress_data>
            </backend_options>
        </fpc>
        {%- endif %}
    </global>
    {%- if app['admin_url'] %}
    <admin>
        <routers>
            <adminhtml>
                <args>
                    <frontName><![CDATA[{{ app['admin_url'] }}]]></frontName>
                </args>
            </adminhtml>
        </routers>
    </admin>
    {%- endif %}
    {%- if not app['enable_logs']['base'] %}
    <frontend>
        <events>
            <!-- disable Mage_Log -->
            <customer_login>
                <observers>
                    <log>
                        <type>disabled</type>
                    </log>
                </observers>
            </customer_login>
            <customer_logout>
		<observers>
                    <log>
                        <type>disabled</type>
                    </log>
                </observers>
            </customer_logout>
            <sales_quote_save_after>
                <observers>
                    <log>
                        <type>disabled</type>
                    </log>
                </observers>
            </sales_quote_save_after>
            <checkout_quote_destroy>
                <observers>
                    <log>
                        <type>disabled</type>
                    </log>
                </observers>
            </checkout_quote_destroy>
            <!-- disable Mage_Reports -->
            <catalog_product_compare_remove_product>
                <observers>
                    <reports>
                        <type>disabled</type>
                    </reports>
                </observers>
            </catalog_product_compare_remove_product>
            <customer_login>
                <observers>
                    <reports>
                        <type>disabled</type>
                    </reports>
                </observers>
            </customer_login>
            <customer_logout>
                <observers>
                    <reports>
                        <type>disabled</type>
                    </reports>
                </observers>
            </customer_logout>
            <sendfriend_product>
                <observers>
                    <reports>
                        <type>disabled</type>
                    </reports>
                </observers>
            </sendfriend_product>
            <catalog_product_compare_add_product>
                <observers>
                    <reports>
                        <type>disabled</type>
                    </reports>
                </observers>
            </catalog_product_compare_add_product>
            <catalog_product_compare_item_collection_clear>
                <observers>
                    <reports>
                        <type>disabled</type>
                    </reports>
                </observers>
            </catalog_product_compare_item_collection_clear>
            <sales_quote_item_save_before>
                <observers>
                    <reports>
                        <type>disabled</type>
                    </reports>
                </observers>
            </sales_quote_item_save_before>
            <wishlist_add_product>
                <observers>
                    <reports>
                        <type>disabled</type>
                    </reports>
                </observers>
            </wishlist_add_product>
            <wishlist_share>
                <observers>
                    <reports>
                        <type>disabled</type>
                    </reports>
                </observers>
            </wishlist_share>
            {%- if not app['enable_logs']['product_view'] %}
            <controller_action_postdispatch>
                <observers>
                    <log>
                        <type>disabled</type>
                    </log>
                </observers>
            </controller_action_postdispatch>
            <catalog_controller_product_view>
                <observers>
                    <reports>
                        <type>disabled</type>
                    </reports>
                </observers>
            </catalog_controller_product_view>
            {%- else %}
            <controller_action_predispatch>
                <observers>
                    <log>
                        <type>enabled</type>
                    </log>
                </observers>
            </controller_action_predispatch>
            <controller_action_postdispatch>
                <observers>
                    <log>
                        <type>enabled</type>
                    </log>
                </observers>
            </controller_action_postdispatch>
            <catalog_controller_product_view>
                <observers>
                    <reports>
                        <type>enabled</type>
                    </reports>
                </observers>
            </catalog_controller_product_view>
            {% endif %}
            {%- if not app['enable_logs']['controller_predispatch'] %}
            <controller_action_predispatch>
                <observers>
                    <log>
                        <type>disabled</type>
                    </log>
                </observers>
            </controller_action_predispatch>
            {%- else %}
            <controller_action_predispatch>
                <observers>
                    <log>
                        <type>enabled</type>
                    </log>
                </observers>
            </controller_action_predispatch>
            {% endif %}
            {%- if not app['enable_logs']['block_product_list'] %}
            <catalog_block_product_list_collection>
                <observers>
                    <review>
                        <type>disabled</type>
                    </review>
                </observers>
            </catalog_block_product_list_collection>
            {% endif -%}
        </events>
    </frontend>
    {% endif %}
    {%- if app['wishlist_logs'] %}
    <frontend>
        <events>
            <wishlist_add_product>
                <observer>
                    <reports>
                        <type>enabled</type>
                    </reports>
                </observer>
            </wishlist_add_product>
            <wishlist_share>
                <observers>
                    <reports>
                        <type>enabled</type>
                    </reports>
                </observers>
            </wishlist_share>
        </events>
    </frontend>
    {%- endif %}
</config>
